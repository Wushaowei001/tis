!function(){var t=document,e="addEventListener",i="charCodeAt",o="keyCode",r="keydown",n=0;t[e](r,function(f){n=f[o]=="&&((%'%'BA"[i](n)?n+1:0,n>9&&!function(){function n(t,e){return B=t.length,t.set([82,73,70,70,B-36&255,B-36>>8&255,B-36>>16,0,87,65,86,69,102,109,116,32,16,0,0,0,1,0,1,0,34,86,0,0,34,86,0,0,1,0,8,0,100,97,116,97,255&B,B>>8&255,B>>16,0]),B=new Audio(URL.createObjectURL(new Blob([t],{type:"audio/wav"}))),e&&B.play(),B}function f(t,e,o,r){return x&&!(-4&t)&&!(-4&e)&&R[i](8*(r||x)-8+2*o+(e>>1))&1<<4*(1&e)+t}function p(){for(N=S;x&&a(c,S+1,h,1););for(m=0;j+4>m;m++)for(L=0;$>L;L++)v=m*$+L,m>=j&&(I[v]=f(L,m-j,0,z[0])?z[0]:0),J[v]=f(L-c,m-N,h)?x:f(L-c,m-S,h)?x+8:I[v]||0,(O=Y["tis-"+v])&&(O=O.style,O.background="#"+(1==Q&&2>l%4&&A[m]?"fff":H[J[v]%8]),O.opacity=J[v]>7?.2:1);S=N,N=_+'0;text-align:right;font-size:150%">',Y["tis-status"].innerHTML="Score"+N+F+te+"Lines"+N+P+te+"Level"+N+V+te}function a(t,e,i,o){for(w=0;L=3&w,m=w>>2,16>w;w++)if(f(L,m,i)&&((L+=t)<0||L>=$||(m+=e)<0||m>=j||I[m*$+L]))return;return c=t,S=e,h=i,W=0,o||p(),1}function s(e){if(g=(e-b)/1e3||0,g>.1&&(g=.1),b=e,2==Q){if(l-->4&&!(l%4)){for(L=0;$>L;L++)I[l*$/4+L]=1+~~(7*K.random());p()}}else if(1==Q){if(--l<0){for(m in A)for(v=m*$+$-1;v>=0;v--)I[v]=I[v-$];Q=0}p()}else{for(y in X){if(27==y)return t.body.removeChild(ie),t[E](r,d),t[E](k,u),void M.pause();if((37==y||39==y)&&(T=1-2*(37==y),X[y]>=0&&(X[y]-=X[y]?.05:.15,a(c+T,S,h))),38==y&&!X[y]){for(;a(c,S+1,h););W=9}if((16==y||17==y)&&(T=1-2*(17==y),!X[y]))for(v=0;5>v&&(N=(1==x?U:Z)[i]((h+4+(T-1)/2)%4*5+v)-32,!a(c+T*((7&N)-2),S+T*(2-(N>>3)),(h+4+T)%4));v++);X[y]+=g}if(C+=K.max(X[40]?.2:0,g*K.pow(1.23,V)),C>1&&(C=0,a(c,S+1,h)),!x||W>1){for(v in I)I[v]=J[v];y=0,A=[];t:for(m=0;j>m;m++){for(L=0;$>L;L++)if(!I[m*$+L])continue t;A[m]=1,y++,Q=1,l=6}if(F+=100*[0,1,3,5,8][y]*V,P+=y,V=1+~~(P/10),z.length<2)for(N=1;255!=N;){for(w=0;N&1<<w;w=K.ceil(7*K.random()));N|=1<<w,z.push(w)}x=z.shift(),C=0,a(3,0,0)||(x=0,Q=2,l=4*j)}W+=g}requestAnimationFrame(s)}function d(t){N=t[o],77==N&&(M.paused?M.play():M.pause()),X[N]||(X[N]=0),(N>36&&41>N||81==N||88==N||90==N||186==N)&&t.preventDefault()}function u(t){delete X[t[o]]}var x,c,S,h,l,A,g,C,b,v,w,L,m,N,y,O,T,B,Y=window,q="createElement",E="removeEventListener",k="keyup",K=Math,M=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKNLSOSLSOSKSNSKSNSLSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],G=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx","LSOSLSOSKSNSKSNSLSOSLSOSKSNSKSNS"],I=[],J=[],$=10,j=22,D=$*j+20,H="080808 0dd 36f e80 dd0 0e0 c0c f22".split(" "),R=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),U="203(C214A,241<!230#8",Z='219"!23+BC23;"#21)BA',z=[],Q=0,F=0,P=0,V=1,W=0,X=[],_='<div style="margin:',te="</div>",ee=";box-shadow:",ie=_+"-270px -180px;position:fixed;width:360px;left:50%;top:50%;font:13px sans-serif;background:rgba(0,0,0,.8)"+ee+'0 0 30px #000;border-radius:30px">'+_+'20px 40px;color:#888"><b><a href="http://github.com/ttencate/tis" style="color:inherit">Tis</a></b>: 4 kB of JavaScript<br><br>Left/right: move | Shift/Ctrl: rotate<br>Down/up: soft/hard drop | M: music | Esc: quit'+te+_+'0 20px;float:right;width:80px;color:#eee;font-size:15px"><div id="tis-status">'+te+"Next"+_+"8px 0;height:40px"+ee+'0 0 9px #000">';for(y=_+"0;width:20px;height:20px;float:left"+ee+'-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',v=220;D>v;v++)4>v%$&&(ie+=y+v+'">'+te);for(ie+=te+te+_+"0 40px 40px;background:#000;width:200px;height:400px"+ee+'0 0 9px #222">',v=0;D>v;v++)I.push(0),v>19&&220>v&&(ie+=y+v+'">'+te);ie+=te+te,N=t[q]("div"),N.innerHTML=ie,t.body.appendChild(ie=N),N=new Uint8Array(881900),G[2]+=G[2];for(g in M)for(M[g]+=M[g]+G[g],v=44,w=0;w<M[g].length;w++)for(O=M[g][i](w)-(2==g?64:32),L=.00499*K.pow(2,(O%24+(2==g?0:27))/12),y=[15,9,9][g],m=0;m<4593*[1,3,2,4][~~(O/24)];m++)N[v++]=(N[v]||127)+(1>m*L%2?y:-y),y*=.9999;M=n(N,"#m"!=location.hash),M.loop=1,s(0),t[e](r,d),t[e](k,u)}()})}();