!function(){var e,t=document,i="addEventListener",o="charCodeAt",n="keyCode",r="keydown",f=0;t[i](r,function(c){f=c[n]=="&&((%'%'BA"[o](f)?f+1:0,!e&&f>9&&(e=3,function(){function f(e){if(k=J[e])k.currentTime=0;else{k=new Uint8Array(9e3),Y=50;for(y in k)B=y>1e3?e>>4&63:e>>10,k[y]=127+(Y*=1-(15&e)/1e4)*(B/2>y/10%B?-1:1);k=J[v]=c(k)}k.play()}function c(e){return k=e.length,new Audio(URL.createObjectURL(new Blob(["RIFF",new Uint32Array([k+36,1163280727,544501094,16,65537,22050,22050,524289,1635017060,k]),e],{type:"audio/wav"})))}function p(e,t,i,n){return S&&!(-4&e)&&!(-4&t)&&Z[o](8*(n||S)-8+2*i+(t>>1))&1<<4*(1&t)+e}function a(){for(N=h;S&&s(A,h+1,g,1););for(T=0;D+4>T;T++)for(m=0;R>m;m++)v=T*R+m,T>=D&&($[v]=p(m,T-D,0,P[0])?P[0]:0),j[v]=p(m-A,T-N,g)?S:p(m-A,T-h,g)?S+8:$[v]||0,(B=q["tis-"+v])&&(B=B.style,B.background="#"+(1==e&&2>w%4&&b[T]?"fff":H[j[v]%8]),B.opacity=j[v]>7?.2:1);h=N,N=tt+'0;text-align:right;font-size:150%">',q["tis-status"].innerHTML="Score"+N+V+it+"Lines"+N+W+it+"Level"+N+X+it}function s(e,t,i,o){for(y=0;m=3&y,T=y>>2,16>y;y++)if(p(m,T,i)&&((m+=e)<0||m>=R||(T+=t)<0||T>=D||$[T*R+m]))return;return A=e,h=t,g=i,_=0,o||a(),1}function d(t){if(e){if(x=(t-L)/1e3||0,x>.1&&(x=.1),L=t,2==e){if(w-->4&&!(w%4)){for(m=0;R>m;)$[w*R/4+m++]=1+~~(7*G.random());a()}}else if(1==e){if(--w<0){for(T in b)for(v=T*R+R-1;v>=0;v--)$[v]=$[v-R];e=3}a()}else{for(O in et){if((37==O||39==O)&&et[O]>=0&&(et[O]-=et[O]?.05:.2,s(A+1-2*(37==O),h,g)),32==O&&!et[O]){for(;s(A,h+1,g););_=9}if((38==O||18==O||17==O)&&(Y=1-2*(17==O),!et[O]))for(v=0;5>v;)if(N=(1==S?z:Q)[o]((g+4+(Y-1)/2)%4*5+v++)-32,s(A+Y*((7&N)-2),h+Y*(2-(N>>3)),(g+4+Y)%4)){f(8303);break}et[O]+=x}if(C+=G.max(et[40]?.2:0,x*G.pow(1.23,X)),C>1&&(C=0,s(A,h+1,g)),_>1){S&&f(31445);for(v in $)$[v]=j[v];O=0,b=[];e:for(T=0;D>T;T++){for(m=0;R>m;)if(!$[T*R+m++])continue e;b[T]=e=1,O++,w=6}if(O&&f([,8392,8260,8242,8225][O]),V+=100*[0,1,3,5,8][O]*X,W+=O,X=1+~~(W/10),P.length<2)for(N=1;255!=N;){for(y=0;N&1<<y;y=1+~~(7*G.random()));N|=1<<y,P.push(y)}S=P.shift(),C=0,s(3,0,0)||(S=0,e=2,w=4*D,f(31360))}_+=x}requestAnimationFrame(d)}}function u(i){N=i[n],77==N&&I[I.paused?"play":"pause"](),27==N&&(t.body.removeChild(ot),t[K](r,u),t[K](M,l),I.pause(),e=0),et[N]=et[N]||0,[17,18,27,37,38,39,40,77].indexOf(N)>=0&&i.preventDefault()}function l(e){delete et[e[n]]}var S,A,h,g,w,b,x,C,L,v,y,m,T,N,O,B,Y,k,q=window,E="createElement",K="removeEventListener",M="keyup",G=Math,I=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKNLSOSLSOSKSNSKSNSLSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],U=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx","LSOSLSOSKSNSKSNSLSOSLSOSKSNSKSNS"],J=[],$=[],j=[],R=10,D=22,F=R*D+20,H="08080890dd936f9e809dd090e09c0c9f22".split(9),Z=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),z="203(C214A,241<!230#8",Q='219"!23+BC23;"#21)BA',P=[],V=0,W=0,X=1,_=2,et=[],tt='<div style="margin:',it="</div>",ot=tt+'-14pc -10pc;position:fixed;width:20pc;left:50%;top:50%;font:12px Arial;background:rgba(0,0,0,.8);box-shadow:0 0 2pc #000;border-radius:1pc">'+tt+'1pc 2pc;color:#888"><b><a href="http://github.com/ttencate/tis" style="color:inherit">Tis</a></b>: Tetris clone in just 4 kB of JavaScript<br><br>Left/right: move | Up/Ctrl/Alt: rotate | Esc: quit<br>Down/space: soft/hard drop | M: music'+it+tt+'0 1pc;float:right;color:#eee;font-size:1pc"><div id="tis-status">'+it+"Next"+tt+'8px 0;width:4pc">';for(O=tt+'0;width:1pc;height:1pc;float:left;box-shadow:-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',v=220;F>v;v++)4>v%R&&(ot+=O+v+'">'+it);for(ot+=it+it+tt+'0 2pc 2pc;background:#000;width:10pc;height:20pc">',v=0;F>v;v++)$.push(0),v>19&&220>v&&(ot+=O+v+'">'+it);ot+=it+it,N=t[E]("div"),N.innerHTML=ot,t.body.appendChild(ot=N),N=new Uint8Array(881856),U[2]+=U[2];for(x in I)for(I[x]+=I[x]+U[x],v=0,y=0;y<I[x].length;)for(B=I[x][o](y++)-(2==x?64:32),m=.00499*G.pow(2,(B%24+(2==x?0:27))/12),O=[15,9,9][x],T=0;T<4593*[1,3,2,4][~~(B/24)];)N[v++]=(N[v]||127)+(T++*m%2<1?O:-O),O*=.9999;I=c(N),I.play(),I.loop=1,d(0),t[i](r,u),t[i](M,l)}())})}();