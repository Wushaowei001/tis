!function(){var t=document,e="addEventListener",i="charCodeAt",o="keyCode",n="keydown",r=0;t[e](n,function(f){r=f[o]=="&&((%'%'BA"[i](r)?r+1:0,r>9&&!function(){function r(t,e){return Y=t.length,t.set([82,73,70,70,Y-36&255,Y-36>>8&255,Y-36>>16,0,87,65,86,69,102,109,116,32,16,0,0,0,1,0,1,0,34,86,0,0,34,86,0,0,1,0,8,0,100,97,116,97,255&Y,Y>>8&255,Y>>16,0]),Y=new Audio(URL.createObjectURL(new Blob([t],{type:"audio/wav"}))),e&&Y.play(),Y}function f(t,e,i){Y=new Uint8Array(9e3),L=50;for(v in Y)v>1e3&&(t=e),Y[v]=127+(L*=1-i)*(t/2>v%t?-1:1);r(Y,1)}function p(t,e,o,n){return c&&!(-4&t)&&!(-4&e)&&R[i](8*(n||c)-8+2*o+(e>>1))&1<<4*(1&e)+t}function a(){for(N=h;c&&s(S,h+1,l,1););for(y=0;j+4>y;y++)for(m=0;U>m;m++)v=y*U+m,y>=j&&(J[v]=p(m,y-j,0,Q[0])?Q[0]:0),$[v]=p(m-S,y-N,l)?c:p(m-S,y-h,l)?c+8:J[v]||0,(T=k["tis-"+v])&&(T=T.style,T.background="#"+(1==F&&2>A%4&&g[y]?"fff":H[$[v]%8]),T.opacity=$[v]>7?.2:1);h=N,N=te+'0;text-align:right;font-size:150%">',k["tis-status"].innerHTML="Score"+N+P+ee+"Lines"+N+V+ee+"Level"+N+W+ee}function s(t,e,i,o){for(L=0;m=3&L,y=L>>2,16>L;L++)if(p(m,y,i)&&((m+=t)<0||m>=U||(y+=e)<0||y>=j||J[y*U+m]))return;return S=t,h=e,l=i,X=0,o||a(),1}function d(e){if(b=(e-C)/1e3||0,b>.1&&(b=.1),C=e,2==F){if(A-->4&&!(A%4)){for(m=0;U>m;)J[A*U/4+m++]=1+~~(7*M.random());a()}}else if(1==F){if(--A<0){for(y in g)for(v=y*U+U-1;v>=0;v--)J[v]=J[v-U];F=0}a()}else{for(O in _){if(27==O)return t.body.removeChild(oe),t[E](n,u),t[E](K,x),void G.pause();if((37==O||39==O)&&(B=1-2*(37==O),_[O]>=0&&(_[O]-=_[O]?.05:.2,s(S+B,h,l))),38==O&&!_[O]){for(;s(S,h+1,l););X=9}if((16==O||17==O)&&(B=1-2*(17==O),!_[O]))for(v=0;5>v;)if(N=(1==c?Z:z)[i]((l+4+(B-1)/2)%4*5+v++)-32,s(S+B*((7&N)-2),h+B*(2-(N>>3)),(l+4+B)%4)){f(80,60,.0015);break}_[O]+=b}if(w+=M.max(_[40]?.2:0,b*M.pow(1.23,W)),w>1&&(w=0,s(S,h+1,l)),!c||X>1){c&&f(300,450,5e-4);for(v in J)J[v]=$[v];O=0,g=[];t:for(y=0;j>y;y++){for(m=0;U>m;)if(!J[y*U+m++])continue t;g[y]=1,O++,F=1,A=6}if(O&&f(80,80/O,.001/O),P+=100*[0,1,3,5,8][O]*W,V+=O,W=1+~~(V/10),Q.length<2)for(N=1;255!=N;){for(L=0;N&1<<L;L=1+~~(7*M.random()));N|=1<<L,Q.push(L)}c=Q.shift(),w=0,s(3,0,0)||(c=0,F=2,A=4*j,f(300,400,0))}X+=b}requestAnimationFrame(d)}function u(t){N=t[o],77==N&&(G.paused?G.play():G.pause()),_[N]||(_[N]=0),(N>36&&41>N||81==N||88==N||90==N||186==N)&&t.preventDefault()}function x(t){delete _[t[o]]}var c,S,h,l,A,g,b,w,C,v,L,m,y,N,O,T,B,Y,k=window,q="createElement",E="removeEventListener",K="keyup",M=Math,G=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKNLSOSLSOSKSNSKSNSLSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],I=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx","LSOSLSOSKSNSKSNSLSOSLSOSKSNSKSNS"],J=[],$=[],U=10,j=22,D=U*j+20,H="08080890dd936f9e809dd090e09c0c9f22".split(9),R=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),Z="203(C214A,241<!230#8",z='219"!23+BC23;"#21)BA',Q=[],F=0,P=0,V=0,W=1,X=0,_=[],te='<div style="margin:',ee="</div>",ie=";box-shadow:",oe=te+"-270px -180px;position:fixed;width:360px;left:50%;top:50%;font:13px sans-serif;background:rgba(0,0,0,.8)"+ie+'0 0 30px #000;border-radius:30px">'+te+'20px 40px;color:#888"><b><a href="http://github.com/ttencate/tis" style="color:inherit">Tis</a></b>: 4 kB of JavaScript<br><br>Left/right: move | Shift/Ctrl: rotate<br>Down/up: soft/hard drop | M: music | Esc: quit'+ee+te+'0 20px;float:right;width:80px;color:#eee;font-size:15px"><div id="tis-status">'+ee+"Next"+te+"8px 0;height:40px"+ie+'0 0 9px #000">';for(O=te+"0;width:20px;height:20px;float:left"+ie+'-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',v=220;D>v;v++)4>v%U&&(oe+=O+v+'">'+ee);for(oe+=ee+ee+te+"0 40px 40px;background:#000;width:200px;height:400px"+ie+'0 0 9px #222">',v=0;D>v;v++)J.push(0),v>19&&220>v&&(oe+=O+v+'">'+ee);oe+=ee+ee,N=t[q]("div"),N.innerHTML=oe,t.body.appendChild(oe=N),N=new Uint8Array(881900),I[2]+=I[2];for(b in G)for(G[b]+=G[b]+I[b],v=44,L=0;L<G[b].length;)for(T=G[b][i](L++)-(2==b?64:32),m=.00499*M.pow(2,(T%24+(2==b?0:27))/12),O=[15,9,9][b],y=0;y<4593*[1,3,2,4][~~(T/24)];)N[v++]=(N[v]||127)+(y++*m%2<1?O:-O),O*=.9999;G=r(N,"#m"!=location.hash),G.loop=1,d(0),t[e](n,u),t[e](K,x)}()})}();