!function(){var t=document,e="addEventListener",i="charCodeAt",o="keyCode",n="keydown",r=0;t[e](n,function(f){r=f[o]=="&&((%'%'BA"[i](r)?r+1:0,r>9&&!function(){function r(t){return Y=t.length,Y=new Audio(URL.createObjectURL(new Blob(["RIFF",new G([Y+36]),"WAVEfmt ",new G([16,65537,22050,22050,524289,1635017060,Y]),t],{type:"audio/wav"}))),Y.play(),Y}function f(t,e,i){Y=new Uint8Array(9e3),L=50;for(v in Y)v>1e3&&(t=e),Y[v]=127+(L*=1-i)*(t/2>v%t?-1:1);r(Y,1)}function p(t,e,o,n){return S&&!(-4&t)&&!(-4&e)&&H[i](8*(n||S)-8+2*o+(e>>1))&1<<4*(1&e)+t}function a(){for(N=h;S&&s(c,h+1,l,1););for(y=0;j+4>y;y++)for(m=0;R>m;m++)v=y*R+m,y>=j&&(U[v]=p(m,y-j,0,Q[0])?Q[0]:0),$[v]=p(m-c,y-N,l)?S:p(m-c,y-h,l)?S+8:U[v]||0,(T=E["tis-"+v])&&(T=T.style,T.background="#"+(1==P&&2>A%4&&g[y]?"fff":F[$[v]%8]),T.opacity=$[v]>7?.2:1);h=N,N=ee+'0;text-align:right;font-size:150%">',E["tis-status"].innerHTML="Score"+N+V+ie+"Lines"+N+W+ie+"Level"+N+X+ie}function s(t,e,i,o){for(L=0;m=3&L,y=L>>2,16>L;L++)if(p(m,y,i)&&((m+=t)<0||m>=R||(y+=e)<0||y>=j||U[y*R+m]))return;return c=t,h=e,l=i,_=0,o||a(),1}function d(e){if(w=(e-C)/1e3||0,w>.1&&(w=.1),C=e,2==P){if(A-->4&&!(A%4)){for(m=0;R>m;)U[A*R/4+m++]=1+~~(7*M.random());a()}}else if(1==P){if(--A<0){for(y in g)for(v=y*R+R-1;v>=0;v--)U[v]=U[v-R];P=0}a()}else{for(O in te){if(27==O)return t.body.removeChild(ne),t[q](n,u),t[q](K,x),void I.pause();if((37==O||39==O)&&(B=1-2*(37==O),te[O]>=0&&(te[O]-=te[O]?.05:.2,s(c+B,h,l))),38==O&&!te[O]){for(;s(c,h+1,l););_=9}if((16==O||17==O)&&(B=1-2*(17==O),!te[O]))for(v=0;5>v;)if(N=(1==S?Z:z)[i]((l+4+(B-1)/2)%4*5+v++)-32,s(c+B*((7&N)-2),h+B*(2-(N>>3)),(l+4+B)%4)){f(80,60,.0015);break}te[O]+=w}if(b+=M.max(te[40]?.2:0,w*M.pow(1.23,X)),b>1&&(b=0,s(c,h+1,l)),!S||_>1){S&&f(300,450,5e-4);for(v in U)U[v]=$[v];O=0,g=[];t:for(y=0;j>y;y++){for(m=0;R>m;)if(!U[y*R+m++])continue t;g[y]=1,O++,P=1,A=6}if(O&&f(80,80/O,.001/O),V+=100*[0,1,3,5,8][O]*X,W+=O,X=1+~~(W/10),Q.length<2)for(N=1;255!=N;){for(L=0;N&1<<L;L=1+~~(7*M.random()));N|=1<<L,Q.push(L)}S=Q.shift(),b=0,s(3,0,0)||(S=0,P=2,A=4*j,f(300,400,0))}_+=w}requestAnimationFrame(d)}function u(t){N=t[o],77==N&&(I.paused?I.play():I.pause()),te[N]||(te[N]=0),(N>36&&41>N||81==N||88==N||90==N||186==N)&&t.preventDefault()}function x(t){delete te[t[o]]}var S,c,h,l,A,g,w,b,C,v,L,m,y,N,O,T,B,Y,E=window,k="createElement",q="removeEventListener",K="keyup",M=Math,G=Uint32Array,I=["`+,^,+Y),`.,C,^`\\Yq^.1e31H,01.,C,^`\\Yq","T$$T,+)$),Y))<$TTYTl.).1^..D,\\.,<$TTTTT`","GNKNGNKNLSOSLSOSKSNSKSNSLSNSL@BCESOSESOSCOCOCOCOBNBN?J?J@CGL@@@@"],J=["xtvstqpsxtvs\\`}|x","tqspqqpptqspY`xx","LSOSLSOSKSNSKSNSLSOSLSOSKSNSKSNS"],U=[],$=[],R=10,j=22,D=R*j+20,F="08080890dd936f9e809dd090e09c0c9f22".split(9),H=atob("8ABERAAPIiJxACYCcAQiA3QAIgZwASMCZgBmAGYAZgA2AGIEYAMxAnIAYgJwAjICYwBkAjAGMgE"),Z="203(C214A,241<!230#8",z='219"!23+BC23;"#21)BA',Q=[],P=0,V=0,W=0,X=1,_=0,te=[],ee='<div style="margin:',ie="</div>",oe=";box-shadow:",ne=ee+"-270px -180px;position:fixed;width:360px;left:50%;top:50%;font:13px sans-serif;background:rgba(0,0,0,.8)"+oe+'0 0 30px #000;border-radius:30px">'+ee+'20px 40px;color:#888"><b><a href="http://github.com/ttencate/tis" style="color:inherit">Tis</a></b>: 4 kB of JavaScript<br><br>Left/right: move | Shift/Ctrl: rotate<br>Down/up: soft/hard drop | M: music | Esc: quit'+ie+ee+'0 20px;float:right;width:80px;color:#eee;font-size:15px"><div id="tis-status">'+ie+"Next"+ee+"8px 0;height:40px"+oe+'0 0 9px #000">';for(O=ee+"0;width:20px;height:20px;float:left"+oe+'-2px -2px 8px rgba(0,0,0,.4) inset,0 0 2px #000 inset" id="tis-',v=220;D>v;v++)4>v%R&&(ne+=O+v+'">'+ie);for(ne+=ie+ie+ee+"0 40px 40px;background:#000;width:200px;height:400px"+oe+'0 0 9px #222">',v=0;D>v;v++)U.push(0),v>19&&220>v&&(ne+=O+v+'">'+ie);ne+=ie+ie,N=t[k]("div"),N.innerHTML=ne,t.body.appendChild(ne=N),N=new Uint8Array(881856),J[2]+=J[2];for(w in I)for(I[w]+=I[w]+J[w],v=0,L=0;L<I[w].length;)for(T=I[w][i](L++)-(2==w?64:32),m=.00499*M.pow(2,(T%24+(2==w?0:27))/12),O=[15,9,9][w],y=0;y<4593*[1,3,2,4][~~(T/24)];)N[v++]=(N[v]||127)+(y++*m%2<1?O:-O),O*=.9999;I=r(N),I.loop=1,d(0),t[e](n,u),t[e](K,x)}()})}();